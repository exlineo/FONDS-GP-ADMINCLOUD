{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport { TokenService } from 'src/app/extranet/systeme/services/token.service';\nimport { CloudGetService } from '../systeme/services/cloud-get.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../systeme/services/cloud-get.service\";\nimport * as i2 from \"src/app/extranet/systeme/services/token.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/material/icon\";\nimport * as i5 from \"@angular/material/tooltip\";\nimport * as i6 from \"@angular/forms\";\n\nfunction CollectionComponent_li_45_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const s_r4 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", s_r4, \" \");\n  }\n}\n\nfunction CollectionComponent_section_52_li_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementStart(2, \"mat-icon\", 23);\n    i0.ɵɵtext(3, \"delete\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const n_r6 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", n_r6.metadonnees[\"dublincore\"].title, \" \");\n  }\n}\n\nfunction CollectionComponent_section_52_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"section\")(1, \"h3\");\n    i0.ɵɵtext(2, \"Notices\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ul\");\n    i0.ɵɵtemplate(4, CollectionComponent_section_52_li_4_Template, 4, 1, \"li\", 19);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.colServ.notices);\n  }\n}\n\nfunction CollectionComponent_section_53_li_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementStart(2, \"mat-icon\", 23);\n    i0.ɵɵtext(3, \"delete\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const n_r8 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", n_r8.metadonnees[\"dublincore\"].title, \" \");\n  }\n}\n\nfunction CollectionComponent_section_53_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"section\")(1, \"h3\");\n    i0.ɵɵtext(2, \"Notices\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ul\");\n    i0.ɵɵtemplate(4, CollectionComponent_section_53_li_4_Template, 4, 1, \"li\", 19);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.colServ.notices);\n  }\n}\n\nexport let CollectionComponent = /*#__PURE__*/(() => {\n  class CollectionComponent {\n    constructor(get, tokenServ) {\n      this.get = get;\n      this.tokenServ = tokenServ;\n      this.fermer = new EventEmitter();\n      this.affiche = false;\n      this.maj = false; // Mettre à jouer les données\n\n      this.cree = false;\n    }\n\n    ngOnInit() {}\n    /**\r\n     * Clic sur une collection\r\n     */\n\n\n    collectionOnClick() {\n      this.affiche = true;\n    }\n    /**\r\n     * Afficher le formulaire de mise à jour\r\n     */\n\n\n    afficheMaj() {\n      this.maj = !this.maj;\n    }\n    /**\r\n     * Méthode utilisée pour la mise à jour ou l'écriture d'une nouvelle collection\r\n     */\n\n\n    ecrire() {// if (this.get.collection.id) {\n      // \tthis.get.majCollection();\n      // } else {\n      // \t// this.colServ.ajouteCollection();\n      // \tthis.get.ajouteNoticeAvantCollection()\n      // }\n    }\n    /**\r\n     * Mapper des données reçues pour faire une collection\r\n     */\n\n\n    mapSet(set) {\n      let tmp = {}; // Peupler les données dans la nouvelle collection\n\n      for (let o in set) {\n        if (tmp.hasOwnProperty(o) && o != '_id') {\n          tmp[o] = set[o];\n        }\n\n        ;\n      }\n\n      ;\n      console.log(tmp);\n      tmp.series = []; // Récupérer les séries dans le SET\n\n      set.documents.forEach(s => {\n        // console.log(s);\n        if (s.nemateria.serie) {\n          const se = s.nemateria.serie;\n          if (!tmp.series.includes(se)) tmp.series.push(se);\n        } // if (s.nemateria.serie && !tmp.series.includes(s.nemateria.serie.serie)) tmp.series.push(s.nemateria.serie.serie);\n\n      }); // Générer la collection\n\n      return tmp;\n    }\n    /**\r\n     * Générer des notices à partir des documents du SET (lorsqu'utile)\r\n     */\n\n\n    genereNotices() {// this.colServ.notices = [];\n      // this.colServ.notifServ.notif('Les notices ont été intégrées dans la collection.');\n    }\n\n    supprimeNotice(id) {}\n\n  }\n\n  CollectionComponent.ɵfac = function CollectionComponent_Factory(t) {\n    return new (t || CollectionComponent)(i0.ɵɵdirectiveInject(i1.CloudGetService), i0.ɵɵdirectiveInject(i2.TokenService));\n  };\n\n  CollectionComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CollectionComponent,\n    selectors: [[\"app-collection\"]],\n    inputs: {\n      collection: \"collection\",\n      idCollection: \"idCollection\"\n    },\n    outputs: {\n      fermer: \"fermer\"\n    },\n    decls: 54,\n    vars: 12,\n    consts: [[1, \"unique\"], [3, \"click\"], [\"f\", \"ngForm\"], [\"for\", \"titre\"], [\"name\", \"titre\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"alias\"], [\"name\", \"alias\", \"required\", \"\", \"pattern\", \"[a-z0-9-]+\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"description\"], [\"mat-input\", \"\", \"name\", \"description\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"type\"], [\"name\", \"type\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"value\", \"images\"], [\"value\", \"multimedia\"], [\"for\", \"createur\"], [\"name\", \"createur\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"fonds\"], [\"name\", \"fonds\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"langue\"], [\"name\", \"langue\", 3, \"ngModel\", \"ngModelChange\"], [4, \"ngFor\", \"ngForOf\"], [1, \"invalid\", 3, \"click\"], [1, \"valid\", 3, \"disabled\", \"click\"], [4, \"ngIf\"], [\"matTooltip\", \"Enlever cette notice\"]],\n    template: function CollectionComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"section\", 0)(1, \"header\")(2, \"h3\");\n        i0.ɵɵtext(3, \"Informations sur la collection \");\n        i0.ɵɵelementStart(4, \"mat-icon\", 1);\n        i0.ɵɵlistener(\"click\", function CollectionComponent_Template_mat_icon_click_4_listener() {\n          return ctx.fermer.emit(false);\n        });\n        i0.ɵɵtext(5, \"close\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(6, \"h2\");\n        i0.ɵɵtext(7);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(8, \"form\")(9, \"section\")(10, \"form\", null, 2)(12, \"article\")(13, \"label\", 3);\n        i0.ɵɵtext(14, \"Titre\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"input\", 4);\n        i0.ɵɵlistener(\"ngModelChange\", function CollectionComponent_Template_input_ngModelChange_15_listener($event) {\n          return ctx.colServ.collection.titre = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"label\", 5);\n        i0.ɵɵtext(17, \"Alias\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"input\", 6);\n        i0.ɵɵlistener(\"ngModelChange\", function CollectionComponent_Template_input_ngModelChange_18_listener($event) {\n          return ctx.colServ.collection.alias = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"label\", 7);\n        i0.ɵɵtext(20, \"Description\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"textarea\", 8);\n        i0.ɵɵlistener(\"ngModelChange\", function CollectionComponent_Template_textarea_ngModelChange_21_listener($event) {\n          return ctx.colServ.collection.description = $event;\n        });\n        i0.ɵɵtext(22, \"                    \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"label\", 9);\n        i0.ɵɵtext(24, \"Type\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"select\", 10);\n        i0.ɵɵlistener(\"ngModelChange\", function CollectionComponent_Template_select_ngModelChange_25_listener($event) {\n          return ctx.colServ.collection.type = $event;\n        });\n        i0.ɵɵelementStart(26, \"option\", 11);\n        i0.ɵɵtext(27, \"Images\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(28, \"option\", 12);\n        i0.ɵɵtext(29, \"Multim\\u00E9dia\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(30, \"label\", 13);\n        i0.ɵɵtext(31, \"Cr\\u00E9ateur\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(32, \"input\", 14);\n        i0.ɵɵlistener(\"ngModelChange\", function CollectionComponent_Template_input_ngModelChange_32_listener($event) {\n          return ctx.colServ.collection.createur = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(33, \"label\", 15);\n        i0.ɵɵtext(34, \"Fonds\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(35, \"input\", 16);\n        i0.ɵɵlistener(\"ngModelChange\", function CollectionComponent_Template_input_ngModelChange_35_listener($event) {\n          return ctx.colServ.collection.fonds = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(36, \"label\", 17);\n        i0.ɵɵtext(37, \"Langue\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(38, \"input\", 18);\n        i0.ɵɵlistener(\"ngModelChange\", function CollectionComponent_Template_input_ngModelChange_38_listener($event) {\n          return ctx.colServ.collection.langue = $event;\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(39, \"article\")(40, \"h3\");\n        i0.ɵɵtext(41, \"S\\u00E9ries\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(42, \"mat-icon\");\n        i0.ɵɵtext(43, \"add\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(44, \"ul\");\n        i0.ɵɵtemplate(45, CollectionComponent_li_45_Template, 2, 1, \"li\", 19);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(46, \"hr\");\n        i0.ɵɵelementStart(47, \"p\")(48, \"button\", 20);\n        i0.ɵɵlistener(\"click\", function CollectionComponent_Template_button_click_48_listener() {\n          return ctx.fermer.emit(false);\n        });\n        i0.ɵɵtext(49, \"Annuler\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(50, \"button\", 21);\n        i0.ɵɵlistener(\"click\", function CollectionComponent_Template_button_click_50_listener() {\n          return ctx.ecrire();\n        });\n        i0.ɵɵtext(51, \"Enregistrer la collection\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵtemplate(52, CollectionComponent_section_52_Template, 5, 1, \"section\", 22);\n        i0.ɵɵtemplate(53, CollectionComponent_section_53_Template, 5, 1, \"section\", 22);\n        i0.ɵɵelementEnd()();\n      }\n\n      if (rf & 2) {\n        const _r0 = i0.ɵɵreference(11);\n\n        i0.ɵɵadvance(7);\n        i0.ɵɵtextInterpolate(ctx.colServ.collection.titre);\n        i0.ɵɵadvance(8);\n        i0.ɵɵproperty(\"ngModel\", ctx.colServ.collection.titre);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.colServ.collection.alias);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.colServ.collection.description);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.colServ.collection.type);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngModel\", ctx.colServ.collection.createur);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.colServ.collection.fonds);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.colServ.collection.langue);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngForOf\", ctx.colServ.collection.series);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"disabled\", _r0.invalid || ctx.tokenServ.statut < 2);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.colServ.notices);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.cree);\n      }\n    },\n    dependencies: [i3.NgForOf, i3.NgIf, i4.MatIcon, i5.MatTooltip, i6.ɵNgNoValidate, i6.NgSelectOption, i6.ɵNgSelectMultipleOption, i6.DefaultValueAccessor, i6.SelectControlValueAccessor, i6.NgControlStatus, i6.NgControlStatusGroup, i6.RequiredValidator, i6.PatternValidator, i6.NgModel, i6.NgForm]\n  });\n  return CollectionComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}